<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout}" lang="vi">
<head>
    <title>Trạng thái đơn hàng - Highland Coffee</title>
    <meta http-equiv="refresh" content="30">
</head>
<body>
<div layout:fragment="content">
    <div th:if="${order != null}" class="max-w-2xl mx-auto">
        <!-- Success Header -->
        <div class="text-center mb-8">
            <div class="w-20 h-20 mx-auto mb-4 bg-green-100 rounded-full flex items-center justify-center">
                <i class="fas fa-check text-4xl text-green-500"></i>
            </div>
            <h1 class="font-display text-3xl text-espresso mb-2">Đặt hàng thành công!</h1>
            <p class="text-coffee-600">Cảm ơn bạn đã đặt hàng tại Highland Coffee</p>
        </div>

        <!-- Order Info Card -->
        <div class="bg-white rounded-xl shadow-lg overflow-hidden mb-6">
            <div class="bg-espresso text-cream px-6 py-4">
                <div class="flex justify-between items-center">
                    <div>
                        <p class="text-coffee-300 text-sm">Mã đơn hàng</p>
                        <p class="text-2xl font-bold" th:text="${order.orderNumber}">#ORDER</p>
                    </div>
                    <div class="text-right">
                        <span th:class="'px-4 py-2 rounded-full text-sm font-semibold ' + ${order.statusBadgeClass}"
                              th:text="${order.statusDisplay}">
                            Status
                        </span>
                    </div>
                </div>
            </div>

            <!-- Status Timeline -->
            <div class="px-6 py-6 border-b border-coffee-100">
                <div class="flex justify-between items-center">
                    <div class="flex flex-col items-center">
                        <div th:class="'w-10 h-10 rounded-full flex items-center justify-center ' + 
                                      (${order.status == 'PENDING' || order.status == 'APPROVED' || 
                                         order.status == 'COOKING' || order.status == 'DONE'} ? 
                                       'bg-green-500 text-white' : 'bg-gray-200 text-gray-500')">
                            <i class="fas fa-clipboard-list"></i>
                        </div>
                        <span class="text-xs mt-2 text-coffee-600">Đã nhận</span>
                    </div>
                    <div class="flex-1 h-1 mx-2" 
                         th:class="${order.status == 'APPROVED' || order.status == 'COOKING' || order.status == 'DONE'} ? 'bg-green-500' : 'bg-gray-200'"></div>
                    <div class="flex flex-col items-center">
                        <div th:class="'w-10 h-10 rounded-full flex items-center justify-center ' + 
                                      (${order.status == 'APPROVED' || order.status == 'COOKING' || order.status == 'DONE'} ? 
                                       'bg-green-500 text-white' : 'bg-gray-200 text-gray-500')">
                            <i class="fas fa-check"></i>
                        </div>
                        <span class="text-xs mt-2 text-coffee-600">Xác nhận</span>
                    </div>
                    <div class="flex-1 h-1 mx-2"
                         th:class="${order.status == 'COOKING' || order.status == 'DONE'} ? 'bg-green-500' : 'bg-gray-200'"></div>
                    <div class="flex flex-col items-center">
                        <div th:class="'w-10 h-10 rounded-full flex items-center justify-center ' + 
                                      (${order.status == 'COOKING' || order.status == 'DONE'} ? 
                                       'bg-green-500 text-white' : 'bg-gray-200 text-gray-500')">
                            <i class="fas fa-blender"></i>
                        </div>
                        <span class="text-xs mt-2 text-coffee-600">Pha chế</span>
                    </div>
                    <div class="flex-1 h-1 mx-2"
                         th:class="${order.status == 'DONE'} ? 'bg-green-500' : 'bg-gray-200'"></div>
                    <div class="flex flex-col items-center">
                        <div th:class="'w-10 h-10 rounded-full flex items-center justify-center ' + 
                                      (${order.status == 'DONE'} ? 'bg-green-500 text-white' : 'bg-gray-200 text-gray-500')">
                            <i class="fas fa-mug-hot"></i>
                        </div>
                        <span class="text-xs mt-2 text-coffee-600">Hoàn thành</span>
                    </div>
                </div>
            </div>

            <!-- Order Items -->
            <div class="px-6 py-4">
                <h3 class="font-semibold text-espresso mb-3">Chi tiết đơn hàng</h3>
                <div th:each="item : ${order.orderItems}" class="flex justify-between py-2 border-b border-coffee-50 last:border-0">
                    <div>
                        <span th:text="${item.productName}">Product</span>
                        <span class="text-coffee-500 ml-2" th:text="'x' + ${item.quantity}">x1</span>
                    </div>
                    <span class="font-medium" th:text="${#numbers.formatDecimal(item.totalPrice, 0, 'COMMA', 0, 'POINT')} + 'đ'">0đ</span>
                </div>
            </div>

            <!-- Table & Customer Info -->
            <div class="px-6 py-4 border-t border-coffee-100">
                <div class="grid grid-cols-2 gap-4 text-sm">
                    <div th:if="${order.cafeTable != null}">
                        <span class="text-coffee-500">Số bàn:</span>
                        <span class="font-medium text-espresso ml-2" th:text="${order.cafeTable.displayName}">Bàn 1</span>
                    </div>
                    <div th:if="${order.customer != null && order.customer.fullName != null}">
                        <span class="text-coffee-500">Khách hàng:</span>
                        <span class="font-medium text-espresso ml-2" th:text="${order.customer.fullName}">Tên</span>
                    </div>
                    <div th:if="${order.guestName != null && !order.guestName.isEmpty()}">
                        <span class="text-coffee-500">Khách hàng:</span>
                        <span class="font-medium text-espresso ml-2" th:text="${order.guestName}">Tên</span>
                    </div>
                </div>
                <div th:if="${order.customerNotes != null && !order.customerNotes.isEmpty()}" class="mt-3">
                    <span class="text-coffee-500 text-sm">Ghi chú:</span>
                    <p class="text-espresso text-sm mt-1" th:text="${order.customerNotes}">Notes</p>
                </div>
            </div>

            <!-- Total -->
            <div class="px-6 py-4 bg-coffee-50">
                <div class="flex justify-between font-bold text-lg">
                    <span>Tổng cộng:</span>
                    <span class="text-espresso" th:text="${#numbers.formatDecimal(order.totalAmount, 0, 'COMMA', 0, 'POINT')} + 'đ'">0đ</span>
                </div>
                <p class="text-coffee-600 text-sm mt-1">Thanh toán: Tiền mặt</p>
            </div>
        </div>

        <!-- Actions -->
        <div class="flex flex-col sm:flex-row gap-4">
            <a th:href="@{/menu}" class="flex-1 bg-coffee-600 hover:bg-coffee-700 text-white text-center py-3 rounded-lg font-medium transition duration-200">
                <i class="fas fa-plus mr-2"></i> Đặt thêm
            </a>
            <a th:href="@{/}" class="flex-1 border border-coffee-300 text-coffee-700 hover:bg-coffee-50 text-center py-3 rounded-lg font-medium transition duration-200">
                <i class="fas fa-home mr-2"></i> Về trang chủ
            </a>
        </div>

        <p class="text-center text-coffee-500 text-sm mt-6">
            <i class="fas fa-sync-alt mr-1"></i> Trang tự động cập nhật mỗi 30 giây
        </p>
    </div>

    <div th:if="${order == null}" class="text-center py-16">
        <i class="fas fa-search text-6xl text-coffee-300 mb-4"></i>
        <p class="text-coffee-600 text-xl" th:text="${error ?: 'Không tìm thấy đơn hàng'}">Error</p>
        <a th:href="@{/menu}" class="inline-block mt-4 bg-coffee-600 hover:bg-coffee-700 text-white px-6 py-3 rounded-lg font-medium">
            <i class="fas fa-arrow-left mr-2"></i> Quay lại Menu
        </a>
    </div>
</div>
</body>
</html>

